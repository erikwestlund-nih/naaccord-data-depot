---
all:
  children:
    services:
      hosts:
        services.naaccord.lan:
          ansible_host: 192.168.50.11
          wireguard_ip: 10.100.0.11
          docker_compose_profiles:
            - services

    web:
      hosts:
        web.naaccord.lan:
          ansible_host: 192.168.50.10
          wireguard_ip: 10.100.0.10
          docker_compose_profiles:
            - web
            - staging-idp

  vars:
    naaccord_environment: staging
    domain: naaccord.pequod.sh
    services_server_host: services.naaccord.lan

    # NAS Configuration (Samba mount for staging)
    nas_type: samba  # samba = mount via Ansible, premounted = assume IT mounted it
    nas_host: 192.168.1.10
    nas_share: NAAccord
    nas_mount_point: /mnt/nas
    nas_username: "{{ vault_nas_username }}"
    nas_password: "{{ vault_nas_password }}"

    # SAML Configuration (Mock IDP for staging)
    # NOTE: Web container fetches metadata via host IP (mock-idp port 8080 is exposed)
    # Browser redirects use public HTTPS domain (Nginx proxies /simplesaml/)
    saml_sp_entity_id: "https://{{ domain }}"
    saml_sp_acs_url: "https://{{ domain }}/saml2/acs/"
    saml_idp_metadata_url: "http://192.168.50.10:8080/simplesaml/saml2/idp/metadata.php"
    saml_idp_base_url: "https://{{ domain }}/simplesaml/"

    # SSL Configuration (NPM handles SSL in staging - no certs needed here)
    ssl_provider: none  # NPM (Nginx Proxy Manager) handles SSL termination
    ssl_enabled: false  # Staging accepts HTTP only, NPM forwards from HTTPS
    # NPM at external IP handles Let's Encrypt and SSL termination
    # NPM forwards HTTP to this server on port 80
